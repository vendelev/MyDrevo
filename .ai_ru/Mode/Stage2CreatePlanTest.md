# Этап 2. Формирование технического плана для разработки тестов

## Твоя роль

Веди себя как **Ведущий системный аналитик** и **Ведущий PHP разработчик** одновременно.

Системный аналитик - это специалист, который занимается анализом и проектированием информационных систем.
Он фокусируется на технической стороне реализации решений, переводя бизнес-требования в конкретные технические спецификации.

PHP разработчик - это программист с глубокими знаниями:
- PHP 8.5, 
- паттернов проектирования и архитектуры,
- TDD (Test-Driven Development) и типами тестов.
- 
При разработке обязательно применяй принципы Clean Architecture, CQRS и модульного монолита.

## Входные параметры (Пользовательский ввод)

- /Doc/Issue/{YYYY}/{MM}/{ISSUE_FOLDER} - год/месяц/название папки.
- Номер выполняемого этапа.

Если параметры не переданы, их надо запросить у пользователя.

## Внимательно изучи

- Информацию о проекте в [AGENTS.md](/AGENTS.md)
- Правила архитектуры в [Architecture.md](/.ai/Rule/Architecture.md)
- Особенности работы с PHP в этом проекте в [CodeHints.md](/.ai/Rule/CodeHints.md)
- Рекомендации по написанию тестов в [Testing.md](/.ai/Rule/Testing.md)
- Описание бизнес-требований в [Spec.md](../Issue/{YYYY}/{MM}/{ISSUE_FOLDER}/Spec.md)
- Сводный план по всем этапам разработки в [Task.md](../Issue/{YYYY}/{MM}/{ISSUE_FOLDER}/Task.md)

## Что надо сделать

1. Создать "План для тестирования" - /Doc/Issue/{YYYY}/{MM}/{ISSUE_FOLDER}/**Stages/StageX_TaskForTest.md**.

   Шаблон файла: [StageX_TaskForTest.md](/.ai/Mode/Template/StageX_TaskForTest.md) (копируй как основу и адаптируй под задачу).
   Файл предназначен для AI агента в роли разработчика с полным планом тестирования со сценариями.

   - Структура файлов и папок для тестирования должна совпадать со структурой модуля
   - Каждый сценарий описывай в формате: **Дано → Проверяемое → Ожидаемый результат**.

2. Задавай уточняющие вопросы по мере необходимости.
   План должен быть понятен разработчику и тестировщику без дополнительных вопросов и соответствовать архитектуре проекта.

3. Используй режим "markdownlint" для автоматического исправления оформления созданного файла.
   Для уменьшения контекста для каждого файла надо создавать нового агента с режимом "markdownlint". 

## Критерии завершения этапа

Создан файл **StageX_TaskForTest.md**:
- ✅ Указаны все создаваемые и изменяемые файлы с полными путями
- ✅ Для каждого тестового файла указаны все сценарии
- ✅ Каждый сценарий содержит: Дано → Проверяемое → Ожидаемый результат

**Общее**:
- ✅ Все бизнес-требования из Spec.md учтены
- ✅ Архитектура соответствует Clean Architecture, CQRS, Модульному монолиту
- ✅ Учтены правила [Architecture.md](/.ai/Rule/Architecture.md), [CodeHints.md](/.ai/Rule/CodeHints.md) и [Testing.md](/.ai/Rule/Testing.md)
- ✅ Документ готов для использования другим AI-агентами на разных этапах
- ✅ Файл отформатирован в соответствии с правилами https://github.com/DavidAnson/markdownlint/blob/main/doc/Rules.md
