# Мультиагентная разработка

***

## Общая концепция

Система состоит из команды специализированных агентов, координируемых оркестратором. 
Каждый агент выполняет определённую роль в процессе разработки. 

Оркестратор управляет последовательностью работы, передаёт результаты между агентами и останавливает процесс 
 при возникновении блокирующих вопросов.

***

## Роли агентов

### Оркестратор

**Функция:** 

- Координация всего процесса разработки
- Ставит задачи другим агентам
- Принимает и анализирует результаты
- Определяет следующие шаги
- Останавливает процесс при блокирующих вопросах
- Управляет циклами review-доработка

### Product Owner

**Функция:** [Описание бизнес потребностей и планирование этапов эпика](/.ai_ru/agents/Stage0CreateEpic.md) 

### Бизнес аналитик

**Функция:** [Описание бизнес-требований](/.ai_ru/agents/Stage1CreateSpec.md)

### Системный аналитик + IT архитектор

**Функция:** [Формирование сводного технического плана](/.ai_ru/agents/Stage2CreatePlanSummary.md)

### Системный аналитик + PHP разработчик

**Функция:** [Формирование технического плана по разработке кода](/.ai_ru/agents/Stage2CreatePlanDev.md)

### Системный аналитик + Разработчик тестов

**Функция:** [Формирование технического плана по написанию тестов](/.ai_ru/agents/Stage2CreatePlanTest.md)

### PHP разработчик

**Функция:** [Разработка программного кода](/.ai_ru/agents/Stage3Implementation.md)

### Разработчик тестов

**Функция:** [Разработка тестов](/.ai_ru/agents/Stage4Testing.md)

### Технический писатель

**Функция:** [Создание технической документации](/.ai_ru/agents/Stage5TechDoc.md)

### IT архитектор

**Функция:** [Создание архитектурной документации](/.ai_ru/agents/Stage6ArchDoc.md)

***

## Схема работы

На каждом этапе мультиагентной разработки шаги работы с агентами будут одинаковы:

1. Создаем новый контекст в режиме "**orchestrator**" и пишем ему команду (см описание каждого этапа).
2. Проводим ревью, вносим правки самостоятельно или даем команду на исправление агенту.
3. Делаем коммит самостоятельно или даем команду: `сделай коммит`.
   Команду агенту надо давать в задаче "**orchestrator**", чтобы агент, имея общий контекст, смог правильно 
   составить комментарий к коммиту.

### Workflow

- Первым выполняется Шаг 0, где создается эпик и этапы.
- Шаг 1 повторяется столько раз, сколько было создано этапов.
- Шаг 2 повторяется для каждого этапа непосредственно перед реализацией.
- Тк технический план тоже разбит на подэтапы, Шаги 3-6 повторяются для каждого подэтапа.
- На Шаге 7 создается человекочитаемая документация.
- На Шаге 8 создается архитектурная документация описывающая взаимодействие и зависимости всей системы.

## Рекомендации

Если задача не большая, то создавать эпик не обязательно. Можно сразу создать спецификацию с описанием 
 бизнес-требований.

После создания эпика создавайте по каждому этапу **только спецификации**.
А технические планы создавайте непосредственно перед началом реализации.

Создание технических планов "на будущее" приводит к тому, что после выполнения текущего этапа приходится 
 пересматривать план реализации следующего этапа.

Для уменьшения контекста и упрощения code-review технический план так же разбивается на несколько подэтапов реализации  
 + по отдельности разработка кода и написание тестов.

## Последовательность работ

### Шаг 0. Описание бизнес требований и планирование этапов эпика

Команда: `/ra-epic <номер эпика> <описание бизнес-потребностей>`

Алгоритм: [ra-epic.md](/.ai_ru/commands/ra-epic.md)

### Шаг 1. Описание функциональных требований

Команда: `/ra-spec <номер задачи> <путь к Summary.md эпика> <номер этапа>`

Алгоритм: [ra-spec.md](/.ai_ru/commands/ra-spec.md)

### Шаг 2. Формирование сводного технического плана

**Рекомендация**: создавайте технический план непосредственно перед разработкой.
Создание плана "на будущее" приводит к тому, что после реализации текущего этапа приходится
пересматривать план разработки следующего этапа.

Команда: `/ra-plan-sum <путь к Spec.md задачи>`

Алгоритм: [ra-plan-sum.md](/.ai_ru/commands/ra-plan-sum.md)

### Шаг 3. Формирование технического плана по разработке кода

Команда: `/ra-plan-dev <путь к папке задачи> <номер этапа>`

Алгоритм: [ra-plan-dev.md](/.ai_ru/commands/ra-plan-dev.md)

### Шаг 4. Формирование технического плана по написанию тестов

Команда: `/ra-plan-test <путь к папке задачи> <номер этапа>`

Алгоритм: [ra-plan-test.md](/.ai_ru/commands/ra-plan-test.md)

### Шаг 5. Разработка программного кода

Команда: `/ra-impl <путь к Task.md задачи> <номер этапа реализации>`

Алгоритм: [ra-impl.md](/.ai_ru/commands/ra-impl.md)

Проводим ревью, вносим правки самостоятельно или даем команду на исправление агенту.
Делаем коммит самостоятельно или даем команду: `сделай коммит`.

### Шаг 6. Написание тестов

Команда: `/ra-test <путь к Task.md задачи> <номер этапа реализации>`

Алгоритм: [ra-test.md](/.ai_ru/commands/ra-test.md)

Проводим ревью, вносим правки самостоятельно или даем команду на исправление агенту.
Делаем коммит самостоятельно или даем команду: `сделай коммит`.

### Шаг 7. Создание технической документации

Команда: `/ra-tech-doc <путь к папке задачи>`

Алгоритм: [ra-tech-doc.md](/.ai_ru/commands/ra-tech-doc.md)

### Шаг 8. Создание архитектурной документации

Команда: `/ra-arch-doc <путь к папке задачи>`

Алгоритм: [ra-arch-doc.md](/.ai_ru/commands/ra-arch-doc.md)
