---
name: ra-php-implementation
description: Разработка программного кода согласно техническому плану с автоматической проверкой качества (PHPStan, Rector, PHPCS)
argument-hint: "<номер этапа> <путь к файлу с техническим планом, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}/TaskSummary.md>"
---

# Разработка программного кода

## Входные данные

$ARGUMENTS

## Алгоритм работы

### Шаг 1. Разработка кода

Вызови Task tool (switch_mode) для разработки кода:

- `subagent_type`: `php-developer`
- `prompt`: "Входные данные (номер задачи из сводного плана и путь к файлу со сводным техническим планом): $ARGUMENTS.
  Разработай код согласно инструкциям.
  Верни список созданных или измененных файлов для последующей проверки"

Дождись завершения работы агента и сохрани список файлов из его ответа.

### Шаг 2. Перепроверка

По окончанию работы агента вызови Task tool (switch_mode) для перепроверки:

- `subagent_type`: `php-developer`
- `prompt`: "Перепроверь созданные файлы {путь к файлу} на соответствие своим инструкциям.
  При необходимости внеси исправления"

Для уменьшения контекста каждому агенту давай задание по проверке только одного файла.

Дождись завершения работы агента и сохрани список замечаний.

### Шаг 3. Автоматическое исправление кода и стиля

Вызови Task tool (switch_mode):

- `subagent_type`: `php-auto-fixer`
- `prompt`: "Исправь код и стиль"

### Шаг 4. Проверка ошибок типов

Вызови Task tool (switch_mode):

- `subagent_type`: `phpstan-developer`
- `prompt`: "Проверь и исправь ошибки типов"

Если агент вернул сообщение об ошибках, перезапусти подзадачу (не более 2-х раз).

### Шаг 5. Проверка стиля кода

Вызови Task tool (switch_mode):

- `subagent_type`: `phpcs-developer`
- `prompt`: "Проверь и исправь стиль кода"

Если агент вернул сообщение об ошибках, перезапусти подзадачу (не более 2-х раз).
