# Мультиагентная разработка: от хотелок до продакшена

---

## Термины

**Бизнес-потребность** — это цель или идея, для выполнения которой нужно выполнить определённые действия.
Бизнес описывает свою **Боль** или почему это надо сделать.
Например: «Операторы тратят 4 часа в день на ручной перенос данных из Excel в CRM».

**Бизнес-требования** — это высокоуровневые цели, которые бизнес стремится достичь.
Product Owner описывает **Цель** или что надо сделать.
Например: «Автоматизировать синхронизацию данных, чтобы сократить ручной труд до 10 минут в день».

**Функциональные требования** - конкретные действия, которые программа должна выполнять.
Бизнес-аналитик формирует **Решение** или как надо сделать.
Например: «Система должна иметь кнопку "Импорт", принимающую файлы .csv и валидирующую поля А и Б».

**Epic (эпик)** — это крупная пользовательская история.
Описывает значимую функциональность или бизнес-цель, достижение которой приносит ценность продукту.

**Feature (фича)** — это законченная единица функциональности программного продукта, которая приносит измеримую
пользу конечному пользователю или бизнесу.

**Task (задача)** — это конкретная единица работы с чётко определённым результатом, которую можно выполнить за
ограниченное время.

---

## Общая концепция

Прежде чем что-то автоматизировать опишу процессы:

1. Заказчик рассказывает о своих хотелках.
2. Владелец продукта формализует полученную информацию в бизнес-требования и предлагает поэтапное выполнение.
3. Бизнес аналитик на основе бизнес-требований прорабатывает как будут реализованы предлагаемые фичи.
4. Системный аналитик совместно с IT архитектором составляют общий план разработки фичи.
5. Системный аналитик и техлид формируют список задач для реализации.
6. Разработка программного обеспечения.
7. Тестирование программного обеспечения.
8. Составление технической документации по разработанному функционалу.
9. Обновление документации по архитектуре всей информационной системы.

И всеми этими процессами управляет проджект-менеджер.

Каждый процесс можно выделить в специализированного AI-агента с определенными умениями и инструкциями.

В итоге получается система из команды агентов, где оркестратор управляет последовательностью работы, передаёт результаты
между агентами и останавливает процесс при возникновении блокирующих вопросов.

---

## Роли AI-агентов

### Project Manager или Оркестратор

**Project Manager** или (Проектный менеджер, PM, проджект-менеджер) — это специалист, который управляет реализацией
проекта от идеи до передачи готового продукта заказчику.

**Функция:**

- Координация всего процесса разработки
- Ставит задачи другим агентам
- Принимает и анализирует результаты
- Определяет следующие шаги
- Останавливает процесс при блокирующих вопросах
- Управляет циклами review-доработка

### Product Owner

**Product Owner** или «владелец продукта» — это специалист, который представляет интересы бизнеса и пользователей,
отвечая за видение продукта, его ценность и развитие.

**Функция:** [Описание бизнес потребностей и планирование этапов эпика](/.ai/agents/epic-writer.md)

### Бизнес аналитик

**Бизнес-аналитик** — это специалист, который занимается анализом бизнес-процессов и требований, предлагает решения,
помогая переводить бизнес-идеи в технические решения.

**Функция:** [Описание бизнес-требований](/.ai/agents/feature-writer.md)

### Системный аналитик + IT архитектор

**Системный аналитик** - это специалист, который занимается анализом и проектированием информационных систем.
Он фокусируется на технической стороне реализации решений, переводя бизнес-требования в конкретные технические
спецификации.

**IT архитектор** — это высококвалифицированный специалист, который проектирует техническую архитектуру системы
(из каких компонентов она состоит и как они взаимодействуют) и отвечает за то,
чтобы решение можно было надежно реализовать и развивать.

**Функция:** [Формирование сводного технического плана](/.ai/agents/summary-plan-writer.md)

### Системный аналитик + PHP Техлид

**Технический лидер** или «техлид» — это наиболее компетентный инженер в команде, который отвечает за качество
технической реализации проекта.

**Функция:** [Формирование технического плана по разработке кода](/.ai/agents/dev-plan-writer.md)

### Системный аналитик + Техлид тестировщик

**Функция:** [Формирование технического плана по написанию тестов](/.ai/agents/test-plan-writer.md)

### PHP разработчик

**Функция:** [Разработка программного кода](/.ai/agents/php-developer.md)

### Разработчик тестов

**Функция:** [Разработка тестов](/.ai/agents/php-test-developer.md)

### Технический писатель

**Технический писатель** — это специалист, который собирает информацию о продукте/системе и превращает её в понятную,
точную и структурированную документацию.

**Функция:** [Создание технической документации](/.ai/agents/tech-doc-writer.md)

### IT архитектор

**Функция:** [Создание архитектурной документации](/.ai/agents/arch-doc-writer.md)

---

## Рекомендации

Если задача не большая, то [создавать эпик не обязательно](examples/FAQ.md#когда-создавать-эпик-а-когда-сразу-фичу).
Можно сразу создать спецификацию с описанием бизнес-требований.

После создания эпика создавайте по каждому этапу **только спецификации для описания фичи**.
А технические планы создавайте непосредственно перед началом реализации.

Создание технических планов "на будущее" приводит к тому, что после выполнения текущего этапа приходится
 пересматривать план реализации следующего этапа.

## Последовательность работ

### Схема работы

На каждом этапе мультиагентной разработки шаги работы с агентами будут одинаковы:

1. Создаем новый контекст в режиме "**orchestrator**" и пишем ему команду (см описание каждого этапа).
2. Проводим ревью, вносим правки самостоятельно или даем команду на исправление агенту.
3. Делаем коммит самостоятельно или даем команду: `сделай коммит`.
   Команду агенту надо давать в задаче "**orchestrator**", чтобы агент, имея общий контекст, смог правильно
   составить комментарий к коммиту.

### Workflow

- Первым выполняется Шаг 0, где создается эпик (описание бизнес требований) и этапы.
- Шаг 1 (описание фичи и функциональных требований) повторяется столько раз, сколько было создано этапов.
- Шаг 2 (общий план разработки) повторяется для каждого этапа (фичи) непосредственно перед реализацией.
- Тк технический план разбивается на задачи, то Шаги 3-8 повторяются для каждого задачи.
- На Шаге 7 создается человекочитаемая документация.
- На Шаге 8 создается архитектурная документация описывающая взаимодействие и зависимости всей системы.

**Пример полного цикла:** См. [Quick Start Guide с примером "Калькулятор валют"](examples/QuickStartGuide.md#пример-калькулятор-валют)

### Шаг 0. Описание бизнес требований и планирование этапов эпика

Команда: `/ra-create-epic <номер эпика из таск-трекер> <бизнес-потребности - что нужно сделать и почему>`

Алгоритм: [ra-create-epic.md](/.ai/commands/ra-create-epic.md)

### Шаг 1. Описание функциональных требований

Команда: `/ra-create-feature <номер задачи из таск-трекер> <путь к EpicSummary.md эпика> <номер этапа>`

Алгоритм: [ra-create-feature.md](/.ai/commands/ra-create-feature.md)

### Шаг 2. Формирование сводного технического плана

**Рекомендация**: создавайте технический план непосредственно перед разработкой.
Создание плана "на будущее" приводит к тому, что после реализации текущего этапа приходится
пересматривать план разработки следующего этапа.

Команда: `/ra-create-summary-plan <Путь к файлу с описанием бизнес-требований, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}/Spec.md>`

Алгоритм: [ra-create-summary-plan.md](/.ai/commands/ra-create-summary-plan.md)

### Шаг 3. Формирование технического плана по разработке кода

Команда: `/ra-create-dev-plan <номер задачи из сводного плана> <путь к папке с описанием бизнес-требований, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}>`

Алгоритм: [ra-create-dev-plan.md](/.ai/commands/ra-create-dev-plan.md)

### Шаг 4. Формирование технического плана по написанию тестов

Команда: `/ra-create-test-plan <номер задачи из сводного плана> <путь к папке с описанием бизнес-требований, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}>`

Алгоритм: [ra-create-test-plan.md](/.ai/commands/ra-create-test-plan.md)

### Шаг 5. Разработка программного кода

Команда: `/ra-php-implementation <номер этапа> <путь к файлу с техническим планом, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}/TaskSummary.md>`

Алгоритм: [ra-php-implementation.md](/.ai/commands/ra-php-implementation.md)

Проводим ревью, вносим правки самостоятельно или даем команду на исправление агенту.
Делаем коммит самостоятельно или даем команду: `сделай коммит`.

### Шаг 6. Написание тестов

Команда: `/ra-php-test-implementation <номер этапа> <путь к файлу с техническим планом, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}/TaskSummary.md>`

Алгоритм: [ra-php-test-implementation.md](/.ai/commands/ra-php-test-implementation.md)

Проводим ревью, вносим правки самостоятельно или даем команду на исправление агенту.
Делаем коммит самостоятельно или даем команду: `сделай коммит`.

### Шаг 7. Создание технической документации

Команда: `/ra-create-tech-doc <Путь к папке задачи, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}>`

Алгоритм: [ra-create-tech-doc.md](/.ai/commands/ra-create-tech-doc.md)

### Шаг 8. Создание архитектурной документации

Команда: `/ra-create-arch-doc <Путь к папке задачи, формат: @/Doc/FeatureList/{YYYY}/{MM}/{FEATURE_FOLDER}>`

Алгоритм: [ra-create-arch-doc.md](/.ai/commands/ra-create-arch-doc.md)

---

## Дополнительные ресурсы

### Правила и соглашения

- **[Architecture.md](rules/Architecture.md)** - правила архитектуры: Clean Architecture, CQRS, модульный монолит
- **[ArchitecturalCompromises.md](rules/ArchitecturalCompromises.md)** - осознанные компромиссы и их обоснование
- **[CodeHints.md](rules/CodeHints.md)** - рекомендации по работе с PHP в проекте
- **[CodeStyle.md](rules/CodeStyle.md)** - принятый стиль кода
- **[TestingHints.md](rules/TestingHints.md)** - рекомендации по написанию тестов
- **[FeatureWorkflow.md](rules/FeatureWorkflow.md)** - workflow добавления новых фич

### Быстрый старт и примеры

- **[Quick Start Guide](examples/QuickStartGuide.md)** - пошаговое руководство с полным примером
- **[Quick Start Checklist](examples/QuickStartChecklist.md)** - краткий чек-лист
- **[FAQ](examples/FAQ.md)** - часто задаваемые вопросы и решения проблем
- **[Примеры документов](examples/filled-examples/)** - EpicSummary, Spec, TaskSummary

### Агенты и команды

- **[Документация агентов](agents/)** - детальное описание всех AI-агентов
- **[Документация команд](commands/)** - алгоритмы работы команд
- **[Шаблоны](agents/Template/)** - шаблоны для всех типов документов

---

## Поддержка

**Если возникли вопросы:**

1. Проверьте [FAQ](examples/FAQ.md)
2. Изучите [примеры](examples/filled-examples/)
3. Перечитайте [Quick Start Guide](examples/QuickStartGuide.md)
4. Создайте issue в репозитории проекта
