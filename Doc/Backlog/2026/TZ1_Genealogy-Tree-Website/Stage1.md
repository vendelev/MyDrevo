# Stage 1 — Подготовка данных и «скелет» продукта

## 1. Название этапа и его краткое описание

**Этап 1:** подготовить основу проекта, чтобы можно было стабильно разворачивать базу данных и показывать первые страницы/эндпоинты.

Результат этапа должен быть демонстрируемым: проект поднимается в Docker, база данных создается воспроизводимо, есть минимальная «заглушка» интерфейса/страниц для проверки.

## 2. Цель этапа

- Привести существующую схему из [`backend/database/migrations/structure.sql`](../../../../backend/database/migrations/structure.sql) к формату, который можно применять в текущем стеке (Laravel + SQLite).
- Зафиксировать минимальный набор доменных понятий для MVP: пользователь, персона, имя/фамилия, связь.
- Зафиксировать минимальный перечень таблиц для MVP: `users`, `family_members`, `relationships`, `relationship_types`.
- Подготовить основу для следующих этапов (просмотр/редактирование данных).

## 3. Функциональные требования

- Система должна уметь **разворачивать схему БД** в текущем окружении проекта без ручных действий.
- Система должна иметь **миграции/скрипт**, который:
  - создает таблицы, необходимые для MVP;
  - учитывает особенности SQLite;
  - может быть запущен повторно в чистом окружении.
- Система должна иметь **минимальный способ проверить**, что БД поднялась:
  - эндпоинт статуса: URL `/status`, формат JSON с полями `status` и `message`;
  - эндпоинт проверяет подключение к БД (например, выполняет простой запрос) и возвращает результат проверки;
  - коды ответов:
    - `200 OK` — БД доступна.
      - пример payload:
        ```json
        {
          "status": "ok",
          "message": "Database connection is healthy"
        }
        ```
    - `500 error` — БД недоступна / ошибка проверки.
      - пример payload:
        ```json
        {
          "status": "error",
          "message": "Database connection failed"
        }
        ```
- Система должна иметь **первичные тестовые данные** (сидирование) для демонстрации: несколько персон и связей.

## 4. Нефункциональные требования

- Развертывание должно быть воспроизводимым через Docker/Makefile.
- Изменения должны соответствовать архитектурным правилам проекта (Clean Architecture + CQRS).
- Документация этапа и результаты должны быть понятны нетехническому пользователю.

## 5. Сценарии использования

1. **Стейкхолдер запускает проект**
   - Открывает инструкцию запуска.
   - Выполняет команду установки/запуска.
   - Видит, что приложение доступно и БД создана.

2. **Разработчик проверяет схему**
   - Запускает миграции.
   - Убеждается, что таблицы для MVP созданы.
   - Видит тестовые данные (например, 3–5 персон и 2–4 связи).

## 6. Критерии приемки

- Проект поднимается в Docker и доступен локально.
- В чистом окружении миграции и сидирование выполняются командой `make php-run CMD="php artisan migrate --seed"` и в результате получается созданная схема БД.
- Сиды создают тестовые данные для демонстрации: **3–5 персон** и **2–4 связи**.
- Есть простой способ проверить доступность БД: эндпоинт `/status` возвращает JSON с полями `status` и `message`, проверяет подключение к БД и использует коды ответов `200 OK` / `500 error`.

## 7. Зависимости

- Нет (это стартовый этап).

## 8. Оценка трудозатрат

- **Оценка:** 1–3 дня.
- **Основные факторы:** перенос SQL под SQLite, подготовка миграций/сидов, минимальная проверочная страница.
