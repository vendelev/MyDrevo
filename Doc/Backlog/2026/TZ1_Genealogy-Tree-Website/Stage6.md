# Stage 5 — Минимальная визуализация дерева и улучшение UX

## 1. Название этапа и его краткое описание

**Этап 5:** сделать просмотр дерева более наглядным: добавить простую визуализацию и улучшить удобство навигации.

Результат этапа должен быть демонстрируемым: пользователь видит дерево не только списком, но и в виде простой схемы.

## 2. Цель этапа

- Добавить минимальную визуализацию семейного дерева.
- Улучшить пользовательский опыт при просмотре и переходах между родственниками.

## 3. Функциональные требования

- Система должна предоставлять страницу «Дерево», где отображается визуальная схема.
- Технология визуализации: **серверный рендер с SVG**.
- Минимальные требования к layout визуализации:
  - древовидная структура (иерархия «родитель → ребёнок» читается визуально);
  - узлы (персоны) отображаются как отдельные элементы с **именем**;
  - между узлами отображаются **линии связей**.
- Визуализация должна поддерживать минимум:
  - отображение выбранной персоны в центре;
  - отображение ближайших связей (родители/дети/супруги) вокруг;
  - переход по клику на другую персону.
- Система должна позволять пользователю выбрать «корневую» персону для просмотра.
- Поведение при превышении лимита узлов:
  - если для отображения требуется более **50 узлов**, система должна отобразить **первые 50 узлов** и показать сообщение: `Дерево слишком большое, отображены первые 50 узлов`.
- Поведение при невалидном `personId` в URL:
  - если персона не найдена, система должна отобразить **корень дерева** (дефолтную корневую персону) и показать сообщение: `Персона не найдена`.

## 4. Нефункциональные требования

- Ограничения отображения:
  - **1 уровень** вокруг выбранной персоны (родители/дети/супруги);
  - **максимум 50 узлов** на схеме.
- Интерфейс должен быть понятным и не перегруженным.
- Должна быть базовая адаптивность для экранов ноутбука и телефона.

## 5. Сценарии использования

1. **Пользователь открывает визуальное дерево**
   - Переходит в раздел «Дерево».
   - Видит выбранного человека и ближайших родственников.

2. **Пользователь исследует родственников**
   - Нажимает на родственника.
   - Схема перестраивается вокруг выбранного человека.

3. **Стейкхолдер оценивает наглядность**
   - Открывает дерево.
   - Видит, что продукт стал визуально понятнее.

## 6. Критерии приемки

- Есть страница «Дерево» с визуализацией.
- Можно кликать по персонам и переходить к их окружению.
- Выбранная персона сохраняется при обновлении страницы через URL (например, `?personId=...`).
- Визуализация не ломается на тестовых данных и работает предсказуемо.

## 7. Зависимости

- Этап 4: есть управление связями и корректные данные.

## 8. Оценка трудозатрат

- **Оценка:** 4–8 дней.
- **Основные факторы:** выбор подхода к визуализации, ограничения по глубине/объему, адаптивность.
