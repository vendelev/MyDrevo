# Указатель задач: Создание и управление профилями членов семьи (Этап 2)

## Обзор
Спецификация разбита на 8 последовательных этапов для инкрементальной реализации. Каждый этап фокусируется на конкретной функциональности, позволяя AI-агенту реализовывать код поэтапно с возможностью тестирования и валидации на каждом шаге.

## Этапы реализации

1. **Этап 1: Подготовка базы данных**
   - Создание миграций для добавления необходимых полей в таблицы `gen_person` и `gen_relation`.
   - Обновление структуры БД для поддержки модели предметной области.
   - [План для разработчика](Stages/Stage1_TaskForDev.md) | [План для тестирования](Stages/Stage1_TaskForTest.md)

2. **Этап 2: Реализация модели FamilyMember**
   - Создание сущности `FamilyMember`, value objects `FullName` и `LifePeriod`.
   - Реализация репозитория для работы с профилями членов семьи.
   - [План для разработчика](Stages/Stage2_TaskForDev.md) | [План для тестирования](Stages/Stage2_TaskForTest.md)

3. **Этап 3: CRUD API для профилей**
   - Реализация команд и запросов для операций создания, чтения, обновления и удаления профилей.
   - Создание контроллеров, DTO и обработчиков CQRS.
   - [План для разработчика](Stages/Stage3_TaskForDev.md) | [План для тестирования](Stages/Stage3_TaskForTest.md)

4. **Этап 4: Валидация профилей**
   - Добавление серверной валидации для полей профилей (даты, обязательные поля).
   - Интеграция валидации в команды создания и обновления.
   - [План для разработчика](Stages/Stage4_TaskForDev.md) | [План для тестирования](Stages/Stage4_TaskForTest.md)

5. **Этап 5: Реализация модели Relationship**
   - Создание сущности `Relationship` для семейных связей.
   - Реализация репозитория для работы со связями.
   - [План для разработчика](Stages/Stage5_TaskForDev.md) | [План для тестирования](Stages/Stage5_TaskForTest.md)

6. **Этап 6: API для связей**
   - Реализация команд для создания и удаления связей.
   - Логика автоматического создания обратных связей.
   - [План для разработчика](Stages/Stage6_TaskForDev.md) | [План для тестирования](Stages/Stage6_TaskForTest.md)

7. **Этап 7: Валидация связей**
   - Добавление проверок на циклические связи, дублирование, логическую целостность.
   - Интеграция валидации в команды связей.
   - [План для разработчика](Stages/Stage7_TaskForDev.md) | [План для тестирования](Stages/Stage7_TaskForTest.md)

8. **Этап 8: Поиск и фильтрация**
   - Реализация поиска профилей по имени/фамилии.
   - Добавление фильтрации в API списка профилей.
   - [План для разработчика](Stages/Stage8_TaskForDev.md) | [План для тестирования](Stages/Stage8_TaskForTest.md)

## Зависимости между этапами
- Этап 1 является фундаментом для всех последующих.
- Этапы 2-4 реализуют базовую функциональность профилей.
- Этапы 5-7 добавляют управление связями.
- Этап 8 завершает функциональность поиском.

Каждый этап включает соответствующие тесты и документацию.
