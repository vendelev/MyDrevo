# План тестирования: Этап 2 - Реализация модели FamilyMember

## Общие принципы тестирования
- **Unit тесты:** Тестирование отдельных классов (сущности, value objects, сервисы).
- **Integration тесты:** Тестирование взаимодействия между компонентами (репозитории, обработчики).
- **E2E тесты:** Тестирование API эндпоинтов.
- **Фреймворк:** PHPUnit для unit/integration, Laravel Dusk или HTTP тесты для E2E.
- **Покрытие:** Минимум 80% кода.

## Структура тестов
Тестовые файлы организованы в директории `backend/tests/Suite/Family/` согласно архитектуре проекта:
- `Domain/`: Unit тесты для сущностей и value objects.
- `Application/`: Integration тесты для use cases, команд и запросов.
- `Presentation/`: E2E тесты для контроллеров и API (если применимо на данном этапе).

## Тесты

### Unit тесты

- **Value Objects (FullName, LifePeriod):**
  - Сценарий: Создание с валидными данными.
    - Дано: Корректные значения для имени, отчества, фамилии (для FullName); даты рождения и смерти (для LifePeriod, где дата смерти опциональна или после рождения).
    - Проверяемое: Инициализация объекта.
    - Ожидаемый результат: Объект создан успешно, свойства установлены правильно.
  - Сценарий: Валидация с невалидными данными.
    - Дано: Пустые строки, недопустимые даты (смерть до рождения).
    - Проверяемое: Попытка создания объекта.
    - Ожидаемый результат: Исключение InvalidArgumentException.

- **Entity (FamilyMember):**
  - Сценарий: Создание и обновление данных.
    - Дано: Валидные данные для всех полей.
    - Проверяемое: Создание сущности и вызов методов обновления.
    - Ожидаемый результат: Данные обновлены, события сгенерированы если применимо.

### Integration тесты

- **Repository (FamilyMemberRepository):**
  - Сценарий: Сохранение нового FamilyMember.
    - Дано: Новый объект FamilyMember.
    - Проверяемое: Вызов метода save().
    - Ожидаемый результат: Данные сохранены в БД, возвращен объект с ID.
  - Сценарий: Извлечение FamilyMember по ID.
    - Дано: Существующий ID.
    - Проверяемое: Вызов метода findById().
    - Ожидаемый результат: Возвращен корректный объект FamilyMember.
  - Сценарий: Обновление существующего FamilyMember.
    - Дано: Измененный объект FamilyMember.
    - Проверяемое: Вызов метода save() для существующего.
    - Ожидаемый результат: Данные обновлены в БД.

### E2E тесты

- **API Endpoints (если применимо на этом этапе):**
  - Сценарий: Создание FamilyMember через API.
    - Дано: Валидный JSON запрос.
    - Проверяемое: POST запрос к эндпоинту.
    - Ожидаемый результат: Статус 201, созданный ресурс в ответе.
  - Сценарий: Получение FamilyMember по ID через API.
    - Дано: Существующий ID.
    - Проверяемое: GET запрос к эндпоинту.
    - Ожидаемый результат: Статус 200, данные FamilyMember в JSON.

## Изменяемые файлы
- `backend/tests/Suite/Family/Domain/FullNameTest.php` (создать)
- `backend/tests/Suite/Family/Domain/LifePeriodTest.php` (создать)
- `backend/tests/Suite/Family/Domain/FamilyMemberTest.php` (создать)
- `backend/tests/Suite/Family/Application/FamilyMemberRepositoryTest.php` (создать)
- `backend/tests/Suite/Family/Presentation/FamilyMemberControllerTest.php` (создать, если E2E применимо)

## Общие рекомендации
- Использовать фабрики для тестовых данных.
- Тестировать исключения и edge cases.
- Запускать тесты после каждого этапа.
- Интеграция с CI/CD для автоматического тестирования.
